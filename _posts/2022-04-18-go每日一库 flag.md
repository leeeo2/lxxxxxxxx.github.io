---
layout: post
title: "go每日一库 flag"
subtitle: "flag"
author: "技术菜鸟"
header-style: text
description: git常用命令
categories: [go每日一库]
tags:
  - go flag
---
# flag 库

官方介绍：[链接](https://pkg.go.dev/flag#FlagSet)

flag库用于解析命令行参数。

## 定义模板
- 返回指针：flag可以将命令行解析后返回指向变量的指针。

```
var (
	host *string = flag.String("host", "", "The host ip")
	port         = flag.Int("port", 5900, "The lenstening port")
)
```

- 绑定变量：将变量绑定到flag解析的字段。

```
var name string
flag.StringVar(&name, "name", "xiaoming", "The user name")
```


## 支持的命令行格式

> 注意bool类型不能使用-flag xxx，只能使用-flag=true格式

```
--flag xxx
--flag=xxx
-flag xxx
-flag=xxx
```

## 支持的类型
boolean int int64 uint int64 float64 duration string 

## 完整例子
```
import (
	"flag"
	"fmt"
)

func main() {
	var (
		host *string = flag.String("host", "", "host ip")
		port         = flag.Int("port", 5900, "port")
	)

	var name string
	flag.StringVar(&name, "name", "kity", "name")
	flag.Parse()
    
    // 打印无法解析的命令行参数
	fmt.Printf("len of args:%d\n", flag.NArg())
	for i, arg := range flag.Args() {
		fmt.Println("arg ", i, " : ", arg)
	}

	fmt.Println("host:", *host)
	fmt.Println("port:", *port)
	fmt.Println("name:", name)
}
```

```
xxx % go run main.go -host=127.0.0.1 -port 0 -name xiaohua
len of args:0
host: 127.0.0.1
port: 0
name: xiaohua
```